import type { LayoutProps } from "../types/index";
import { useLocation } from "react-router-dom";
// import { ButterflyButton } from "../components/widgets/ButterflyButton";
import { SOSButton } from "../components/widgets/SOSButton";
import { NavButton } from "../components/navigation/NavButton";
import { Header } from "../components/navigation/Header";

export const MainLayout = ({ children }: LayoutProps) => {
  // Get current location for active state
  const location = useLocation();
  const currentPath = location.pathname;

  return (
    <div className="min-h-screen bg-white text-zinc-900 flex flex-col">
      {/* Top header with MirrorMe title */}
      <Header />

      <div className="flex flex-1 relative">
        {/* Left side navigation */}
        <aside className="sm:w-24 md:w-28 lg:w-[80px] bg-white border-r flex flex-col items-center md:py-10 lg:py-40 space-y-6 md:space-y-8 fixed h-full z-20">
          <NavButton
            to="/"
            label="צ'אט"
            icon={
              <svg
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M7.5 8.25H16.5M7.5 11.25H12M2.25 12.76C2.25 14.36 3.373 15.754 4.957 15.987C6.086 16.153 7.227 16.28 8.38 16.366C8.73 16.392 9.05 16.576 9.245 16.867L12 21L14.755 16.867C14.8516 16.7233 14.9798 16.6034 15.1297 16.5166C15.2795 16.4298 15.4472 16.3783 15.62 16.366C16.7652 16.2805 17.9069 16.1541 19.043 15.987C20.627 15.754 21.75 14.361 21.75 12.759V6.741C21.75 5.139 20.627 3.746 19.043 3.513C16.711 3.17072 14.357 2.99926 12 3C9.608 3 7.256 3.175 4.957 3.513C3.373 3.746 2.25 5.14 2.25 6.741V12.759V12.76Z"
                  stroke="#333333"
                  strokeWidth="1.5"
                  strokeLinecap="round"
                  strokeLinejoin="round"
                />
              </svg>
            }
            activeIcon={
              <svg
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  fillRule="evenodd"
                  clipRule="evenodd"
                  d="M3.348 0.521002C5.71613 0.173402 8.10649 -0.000728065 10.5 2.2879e-06C12.93 2.2879e-06 15.317 0.178002 17.652 0.520002C19.63 0.812002 21 2.544 21 4.49V10.51C21 12.456 19.63 14.188 17.652 14.48C16.4983 14.6491 15.3389 14.7768 14.176 14.863C14.1168 14.8669 14.0593 14.8842 14.0079 14.9137C13.9564 14.9431 13.9123 14.984 13.879 15.033L11.124 19.166C11.0555 19.2687 10.9627 19.3529 10.8539 19.4112C10.745 19.4694 10.6235 19.4999 10.5 19.4999C10.3765 19.4999 10.255 19.4694 10.1461 19.4112C10.0373 19.3529 9.94449 19.2687 9.876 19.166L7.121 15.033C7.08768 14.984 7.04361 14.9431 6.99214 14.9137C6.94068 14.8842 6.88317 14.8669 6.824 14.863C5.66113 14.7765 4.50172 14.6484 3.348 14.479C1.37 14.189 0 12.455 0 10.509V4.491C0 2.545 1.37 0.811002 3.348 0.521002ZM5.25 6C5.25 5.80109 5.32902 5.61032 5.46967 5.46967C5.61032 5.32902 5.80109 5.25 6 5.25H15C15.1989 5.25 15.3897 5.32902 15.5303 5.46967C15.671 5.61032 15.75 5.80109 15.75 6C15.75 6.19891 15.671 6.38968 15.5303 6.53033C15.3897 6.67098 15.1989 6.75 15 6.75H6C5.80109 6.75 5.61032 6.67098 5.46967 6.53033C5.32902 6.38968 5.25 6.19891 5.25 6ZM6 8.25C5.80109 8.25 5.61032 8.32902 5.46967 8.46967C5.32902 8.61032 5.25 8.80109 5.25 9C5.25 9.19891 5.32902 9.38968 5.46967 9.53033C5.61032 9.67098 5.80109 9.75 6 9.75H10.5C10.6989 9.75 10.8897 9.67098 11.0303 9.53033C11.171 9.38968 11.25 9.19891 11.25 9C11.25 8.80109 11.171 8.61032 11.0303 8.46967C10.8897 8.32902 10.6989 8.25 10.5 8.25H6Z"
                  fill="#4762FF"
                />
              </svg>
            }
            isActive={currentPath === "/"}
          />
          <NavButton
            to="/safe"
            label="הכספת"
            icon={
              <svg
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M16.5 10.5V6.75C16.5 5.55653 16.0259 4.41193 15.182 3.56802C14.3381 2.72411 13.1935 2.25 12 2.25C10.8065 2.25 9.66193 2.72411 8.81802 3.56802C7.97411 4.41193 7.5 5.55653 7.5 6.75V10.5M6.75 21.75H17.25C17.8467 21.75 18.419 21.5129 18.841 21.091C19.2629 20.669 19.5 20.0967 19.5 19.5V12.75C19.5 12.1533 19.2629 11.581 18.841 11.159C18.419 10.7371 17.8467 10.5 17.25 10.5H6.75C6.15326 10.5 5.58097 10.7371 5.15901 11.159C4.73705 11.581 4.5 12.1533 4.5 12.75V19.5C4.5 20.0967 4.73705 20.669 5.15901 21.091C5.58097 21.5129 6.15326 21.75 6.75 21.75Z"
                  stroke="currentColor"
                  strokeWidth="1.5"
                  strokeLinecap="round"
                  strokeLinejoin="round"
                />
              </svg>
            }
            activeIcon={
              <svg
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M18 1.5C20.9 1.5 23.25 3.85 23.25 6.75V10.5C23.25 10.6989 23.171 10.8897 23.0303 11.0303C22.8897 11.171 22.6989 11.25 22.5 11.25C22.3011 11.25 22.1103 11.171 21.9697 11.0303C21.829 10.8897 21.75 10.6989 21.75 10.5V6.75C21.75 5.75544 21.3549 4.80161 20.6517 4.09835C19.9484 3.39509 18.9946 3 18 3C17.0054 3 16.0516 3.39509 15.3483 4.09835C14.6451 4.80161 14.25 5.75544 14.25 6.75V9.75C15.0456 9.75 15.8087 10.0661 16.3713 10.6287C16.9339 11.1913 17.25 11.9544 17.25 12.75V19.5C17.25 20.2956 16.9339 21.0587 16.3713 21.6213C15.8087 22.1839 15.0456 22.5 14.25 22.5H3.75C2.95435 22.5 2.19129 22.1839 1.62868 21.6213C1.06607 21.0587 0.75 20.2956 0.75 19.5V12.75C0.75 11.9544 1.06607 11.1913 1.62868 10.6287C2.19129 10.0661 2.95435 9.75 3.75 9.75H12.75V6.75C12.75 3.85 15.1 1.5 18 1.5Z"
                  fill="#4762FF"
                />
              </svg>
            }
            isActive={currentPath === "/safe"}
          />
          <NavButton
            to="/blog"
            label="קהילה"
            icon={
              <svg
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M20.25 8.511C21.134 8.795 21.75 9.639 21.75 10.608V14.894C21.75 16.03 20.903 16.994 19.77 17.087C19.43 17.114 19.09 17.139 18.75 17.159V20.25L15.75 17.25C14.396 17.25 13.056 17.195 11.73 17.087C11.4413 17.0637 11.1605 16.9813 10.905 16.845M20.25 8.511C20.0955 8.46127 19.9358 8.42939 19.774 8.416C17.0959 8.19368 14.4041 8.19368 11.726 8.416C10.595 8.51 9.75 9.473 9.75 10.608V14.894C9.75 15.731 10.21 16.474 10.905 16.845M20.25 8.511V6.637C20.25 5.016 19.098 3.611 17.49 3.402C15.4208 3.13379 13.3365 2.99951 11.25 3C9.135 3 7.052 3.137 5.01 3.402C3.402 3.611 2.25 5.016 2.25 6.637V12.863C2.25 14.484 3.402 15.889 5.01 16.098C5.587 16.173 6.167 16.238 6.75 16.292V21L10.905 16.845"
                  stroke="currentColor"
                  strokeWidth="1.5"
                  strokeLinecap="round"
                  strokeLinejoin="round"
                />
              </svg>
            }
            activeIcon={
              <svg
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M4.913 2.658C6.988 2.388 9.103 2.25 11.25 2.25C13.397 2.25 15.512 2.389 17.587 2.658C19.509 2.908 20.878 4.519 20.992 6.385C20.6577 6.27362 20.3112 6.20278 19.96 6.174C17.1582 5.94141 14.3418 5.94141 11.54 6.174C9.182 6.37 7.5 8.364 7.5 10.608V14.894C7.49906 15.7178 7.72577 16.5258 8.15512 17.2288C8.58446 17.9319 9.19973 18.5026 9.933 18.878L7.28 21.53C7.17511 21.6348 7.04153 21.7061 6.89614 21.735C6.75074 21.7638 6.60004 21.749 6.46308 21.6923C6.32611 21.6356 6.20903 21.5395 6.12661 21.4163C6.04419 21.2931 6.00013 21.1482 6 21V16.97C5.6372 16.9314 5.27484 16.8888 4.913 16.842C2.905 16.58 1.5 14.833 1.5 12.862V6.638C1.5 4.668 2.905 2.919 4.913 2.658Z"
                  fill="#4762FF"
                />
                <path
                  d="M15.75 7.5C14.374 7.5 13.011 7.557 11.664 7.669C10.124 7.797 9 9.103 9 10.609V14.894C9 16.401 10.128 17.708 11.67 17.834C12.913 17.936 14.17 17.991 15.438 17.999L18.22 20.78C18.3249 20.8848 18.4585 20.9561 18.6039 20.985C18.7493 21.0139 18.9 20.999 19.0369 20.9423C19.1739 20.8856 19.291 20.7896 19.3734 20.6663C19.4558 20.5431 19.4999 20.3982 19.5 20.25V17.86L19.83 17.834C21.372 17.709 22.5 16.401 22.5 14.894V10.608C22.5 9.103 21.375 7.797 19.836 7.668C18.4769 7.55562 17.1137 7.49957 15.75 7.5Z"
                  fill="#4762FF"
                />
              </svg>
            }
            isActive={currentPath === "/blog"}
          />
          <NavButton
            to="/stories"
            label="סיפורים אישיים"
            icon={
              <svg
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M16.862 4.487L18.549 2.799C18.9007 2.44733 19.3777 2.24976 19.875 2.24976C20.3723 2.24976 20.8493 2.44733 21.201 2.799C21.5527 3.15068 21.7502 3.62766 21.7502 4.125C21.7502 4.62235 21.5527 5.09933 21.201 5.451L10.582 16.07C10.0533 16.5984 9.40137 16.9867 8.685 17.2L6 18L6.8 15.315C7.01328 14.5986 7.40163 13.9467 7.93 13.418L16.862 4.487ZM16.862 4.487L19.5 7.125M18 14V18.75C18 19.3467 17.7629 19.919 17.341 20.341C16.919 20.763 16.3467 21 15.75 21H5.25C4.65326 21 4.08097 20.763 3.65901 20.341C3.23705 19.919 3 19.3467 3 18.75V8.25C3 7.65327 3.23705 7.08097 3.65901 6.65901C4.08097 6.23706 4.65326 6 5.25 6H10"
                  stroke="currentColor"
                  strokeWidth="1.5"
                  strokeLinecap="round"
                  strokeLinejoin="round"
                />
              </svg>
            }
            activeIcon={
              <svg
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M21.7313 2.26906C21.239 1.77687 20.5714 1.50037 19.8753 1.50037C19.1791 1.50037 18.5115 1.77687 18.0193 2.26906L16.8623 3.42606L20.5743 7.13806L21.7313 5.98106C22.2234 5.48879 22.4999 4.82117 22.4999 4.12506C22.4999 3.42894 22.2234 2.76133 21.7313 2.26906ZM19.5133 8.19906L15.8013 4.48706L7.40125 12.8871C6.78411 13.5039 6.33043 14.2648 6.08125 15.1011L5.28125 17.7861C5.24263 17.9156 5.23975 18.0532 5.27292 18.1843C5.30608 18.3154 5.37407 18.435 5.46967 18.5306C5.56527 18.6262 5.68494 18.6942 5.81601 18.7274C5.94709 18.7606 6.08469 18.7577 6.21425 18.7191L8.89925 17.9191C9.73548 17.6699 10.4964 17.2162 11.1133 16.5991L19.5133 8.19906Z"
                  fill="#4762FF"
                />
                <path
                  d="M5.25 5.25C4.45435 5.25 3.69129 5.56607 3.12868 6.12868C2.56607 6.69129 2.25 7.45435 2.25 8.25V18.75C2.25 19.5456 2.56607 20.3087 3.12868 20.8713C3.69129 21.4339 4.45435 21.75 5.25 21.75H15.75C16.5456 21.75 17.3087 21.4339 17.8713 20.8713C18.4339 20.3087 18.75 19.5456 18.75 18.75V13.5C18.75 13.3011 18.671 13.1103 18.5303 12.9697C18.3897 12.829 18.1989 12.75 18 12.75C17.8011 12.75 17.6103 12.829 17.4697 12.9697C17.329 13.1103 17.25 13.3011 17.25 13.5V18.75C17.25 19.1478 17.092 19.5294 16.8107 19.8107C16.5294 20.092 16.1478 20.25 15.75 20.25H5.25C4.85218 20.25 4.47064 20.092 4.18934 19.8107C3.90804 19.5294 3.75 19.1478 3.75 18.75V8.25C3.75 7.85218 3.90804 7.47064 4.18934 7.18934C4.47064 6.90804 4.85218 6.75 5.25 6.75H10.5C10.6989 6.75 10.8897 6.67098 11.0303 6.53033C11.171 6.38968 11.25 6.19891 11.25 6C11.25 5.80109 11.171 5.61032 11.0303 5.46967C10.8897 5.32902 10.6989 5.25 10.5 5.25H5.25Z"
                  fill="#4762FF"
                />
              </svg>
            }
            isActive={currentPath === "/stories"}
          />
          <NavButton
            to="/info"
            label="לקריאה נוספת"
            icon={
              <svg
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M17.593 3.322C18.693 3.45 19.5 4.399 19.5 5.507V21L12 17.25L4.5 21V5.507C4.5 4.399 5.306 3.45 6.407 3.322C10.1232 2.89063 13.8768 2.89063 17.593 3.322Z"
                  stroke="currentColor"
                  strokeWidth="1.5"
                  strokeLinecap="round"
                  strokeLinejoin="round"
                />
              </svg>
            }
            activeIcon={
              <svg
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  fillRule="evenodd"
                  clipRule="evenodd"
                  d="M6.32 2.57701C10.094 2.13888 13.906 2.13888 17.68 2.57701C19.177 2.75101 20.25 4.03701 20.25 5.50701V21C20.2498 21.1277 20.217 21.2533 20.1547 21.3648C20.0925 21.4763 20.0027 21.57 19.8941 21.6371C19.7854 21.7042 19.6614 21.7425 19.5338 21.7482C19.4062 21.754 19.2793 21.7271 19.165 21.67L12 18.089L4.835 21.672C4.72058 21.7291 4.59345 21.7561 4.4657 21.7502C4.33795 21.7444 4.21381 21.7059 4.10509 21.6386C3.99637 21.5713 3.90667 21.4772 3.84452 21.3655C3.78237 21.2537 3.74983 21.1279 3.75 21V5.50701C3.75 4.03701 4.823 2.75101 6.32 2.57701Z"
                  fill="#4762FF"
                />
              </svg>
            }
            isActive={currentPath === "/info"}
          />
        </aside>

        {/* Main content - still RTL */}
        <main
          className="flex-1 flex flex-col items-center justify-start mx-auto w-full pt-6 pb-16 md:pb-12 pl-20 sm:pl-24 md:pl-28 lg:pl-32"
          dir="rtl"
        >
          {children}
          {/* Floating helpers */}

          {/* <ButterflyButton /> */}
          <SOSButton />
        </main>
      </div>
    </div>
  );
};
